# 关于营销模块的一切

## 营销通用

### 各种广告的业务描述

营销模块中的广告可以根据用户触发方式分为两种，分别是 `被动触发试` 和 `主动触发试` 

#### 被动触发试

1. 运营弹窗/续费续签强提示(modalAD组件)

    这类广告会在用户「当天第一次」进入插件的「首页」「列表页」或者「详情页」的时候弹出。如果当天关闭过，那当天就不再弹出。

1. 页面上的各个banner(bannerAD组件)

    这类广告会出现在页面上运营指定的各个位置。只要用户不「主动关闭」，那么每次打开这个页面都会出现。如果主动关闭，那么今天就不再出现(明天继续)
    
1. 续费续签中提示

    这类广告也是在用户「当天第一次」进入「首页」「列表页」或者「详情页」的时候弹出。和弹窗组件不同的是，这个组件是定时几秒钟后自己关闭的。关闭后当天不再显示(明天继续)
    
1. 角标中提示(to be sure)

    这个广告是在用户中提示区间内出现的，和中提示一样出现在「首页」「列表页」和「详情页」,(出现位置和关闭情况需和产品确认)

1. 弱提示

    1. 手机端
    
        手机上与公告复用一个组件，出现在「首页」「列表页」「详情页」。当同时有弱提示和公告的时候，采用轮播的方式展示，手动关闭后当天不再出现
        
    1. PC端
        
        PC端为单独提示条，(出现位置需确认)，主动关闭后当天不可见

1. 公告

    1. 手机端
    
        手机上与弱提示复用一个组件，出现在「首页」「列表页」「详情页」。当同时有弱提示和公告的时候，采用轮播的方式展示，手动关闭后当天不再出现
        
    1. PC端
        
        PC端为气泡形式，收起后还是可以再次点开查看，不会真的关闭

#### 主动触发试

1. 功能点广告

    初级版使用高级版功能时会阻止触发，而是展示升级广告，内部包涵功能点的各种介绍和价格。如果不升级的话，关闭后如果再次点击高级版功能还是会出现该广告
    
1. 事后续费

    即将到期的用户看在使用部分高频高级版功能的时候会看到的广告，第一次展现后会收起成球球，再次点击球球会再看到广告，这个时候关闭这个广告，今天就不会出现它了，明天如果触发，则再次展现
    
### 通用功能模块

1. `getAd` 方法

    这个方法用来根据给定的`pid`获取广告系统中的广告信息。获取信息后会做统一处理，具体的处理有：
    
        1. 条件过滤
            
            * 部分广告只给指定vipflag的用户查看
            
            * 售卖广告不会给「自动续费」和「10日内订购」的用户看
            
        2. 随机创意
        
            * 部分pid下会有多个创意用于运营的AB测试，这里统一处理，然后返回随机的一个创意内容
            
1. `showPayResult` 方法

    这个方法是售卖型广告在用户跳转后出现的，用来进行支付确认（收费系统官方暂未提供）
    
1. `goClick` 方法

    广告的点击跳转事件。根据广告中配置的不同type进行不同的点击事件，常规的有「跳转链接」「跳转功能」和「联系客服」

## modalAD组件（适用广告类型：运营弹窗、续费续签强提示）

### 调用方式

弹窗广告埋在三大入口page里，根据当天看广告的情况、用户vipflag、用户到期时间，通过中间层 `marketing` 进行pid筛选，然后交给redux渲染

在不主动清除缓存的情况下，一个用户一天只会看到一次，不存在主动触发的情况

在`marketing`中间层中通过`triggerAdInfoByPid`方法把判断好的pid丢给redux

### tips

## bannerAD组件（适用广告类型：banner）

## afterActionAD组件（适用广告类型：事后续费）
